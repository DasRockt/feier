<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Termin-Umfrage 🎄</title>
<style>
body, html {
  margin:0;
  padding:0;
  height:100%;
  width:100%;
  font-family: Arial, Helvetica, sans-serif;
  background: linear-gradient(180deg,#001219 0%,#02121a 100%);
  overflow:hidden;
  position: relative;
  color: #fff;
}

#formWrapper {
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%, -50%);
  max-width:500px;
  width:90%;
  background: rgba(255,255,255,0.05);
  border-radius: 20px;
  padding:30px;
  text-align:center;
  z-index:10;
  box-shadow: 0 10px 40px rgba(0,0,0,0.6);
  color: #fff;
}

.header{
  display:flex;
  align-items:center;
  justify-content:center;
  gap:20px;
  margin-bottom:20px;
}
.brand{font-weight:900;font-size:2.2rem;}
.lights{display:flex;gap:10px}
.bulb{width:14px;height:22px;border-radius:50% 50% 45% 45%;animation:blink 2s infinite;}
.bulb.red{background:#ff4d4d;box-shadow:0 0 8px rgba(255,77,77,0.8)}
.bulb.green{background:#66ff99;box-shadow:0 0 8px rgba(102,255,153,0.8)}
.bulb.gold{background:#ffd700;box-shadow:0 0 8px rgba(255,215,0,0.8)}
.bulb.blue{background:#6ec8ff;box-shadow:0 0 8px rgba(110,200,255,0.8)}
@keyframes blink {0%,100%{opacity:1}50%{opacity:.3}}

.activity{margin:12px 0;}
.activity .actLabel{font-weight:600;margin-bottom:6px;display:block;color:#fff;}
.options{
  display:flex;
  flex-direction: column;
  align-items: center;
  gap:15px;
}
.options label{display:flex;align-items:center;gap:6px;cursor:pointer;color:#fff;}
.options input[type="checkbox"]{transform:scale(1.1)}

.actions{margin-top:12px;display:flex;gap:10px;flex-wrap:wrap;justify-content:center}
.button{border:0;padding:10px 18px;border-radius:14px;background:linear-gradient(180deg,#ffd27a,#ff8f3c);color:#000;font-weight:800;cursor:pointer}
.ghost{background:transparent;border:1px solid rgba(255,255,255,0.3);color:#fff}

footer{text-align:center;margin-top:12px;font-size:0.85rem;color:#fff}

.fly, .snowflake{
  position:absolute;
  z-index:5;
  user-select:none;
  pointer-events:none;
  font-size:24px;
}
.snowflake { color: #87cefa; }

#thankYouPopup{
  position: fixed;
  top:0; left:0; right:0; bottom:0;
  background: rgba(0,0,0,0.7);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:1000;
  visibility:hidden;
  opacity:0;
  transition: opacity 0.3s ease;
}
#thankYouPopup.show{visibility: visible; opacity:1;}
#thankYouPopup .popup-content{
  background: rgba(0,0,0,0.9);
  padding:30px 50px;
  border-radius:20px;
  text-align:center;
  color:#fff;
  font-size:1.5rem;
  box-shadow:0 0 20px #0ff,0 0 40px #f0f;
}
#thankYouPopup .close-btn{
  margin-top:20px;
  padding:8px 20px;
  border:none;
  border-radius:12px;
  cursor:pointer;
  background:linear-gradient(180deg,#ffd27a,#ff8f3c);
  font-weight:bold;
}

.spotlight{
  position:absolute;
  border-radius:50%;
  width:250px; height:350px;
  filter: blur(50px);
  opacity:0.4;
  z-index:1;
}

#loadingSpinner {
  position: fixed;
  top:0; left:0; right:0; bottom:0;
  background: rgba(0,0,0,0.95);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 2000;
  visibility: hidden;
  opacity: 0;
  transition: opacity 0.3s ease;
}
#loadingSpinner.show { visibility: visible; opacity: 1; }
.spinner { width:60px; height:60px; border:6px solid #fff; border-top:6px solid #ff8f3c; border-radius:50%; animation:spin 1s linear infinite; }
@keyframes spin {0% {transform:rotate(0deg);}100% {transform:rotate(360deg);}}
</style>
</head>
<body>

<div id="formWrapper">
  <div class="header">
    <div class="lights">
      <div class="bulb red"></div><div class="bulb green"></div><div class="bulb gold"></div>
    </div>
    <div class="brand">Termin-Umfrage</div>
    <div class="lights">
      <div class="bulb blue"></div><div class="bulb gold"></div><div class="bulb red"></div>
    </div>
  </div>

  <form id="surveyForm">
    <div class="activity">
      <label class="actLabel" for="nameInput">Dein Name:</label>
      <input type="text" id="nameInput" name="name" required style="padding:8px 10px;border-radius:8px;border:none;width:80%;max-width:400px;">
    </div>

    <div class="activity">
      <div class="actLabel">Bitte wähle die Termine, an denen du kannst:</div>
      <div class="options">
        <label><input type="checkbox" name="Datum1"> Freitag, 21.11.2025</label>
        <label><input type="checkbox" name="Datum2"> Samstag, 22.11.2025</label>
        <label><input type="checkbox" name="Datum3"> Freitag, 28.11.2025</label>
        <label><input type="checkbox" name="Datum4"> Samstag, 29.11.2025</label>
        <label><input type="checkbox" name="Datum5"> Freitag, 05.12.2025</label>
        <label><input type="checkbox" name="Datum6"> Samstag, 06.12.2025</label>
        <label><input type="checkbox" name="Datum7"> Freitag, 12.12.2025</label>
        <label><input type="checkbox" name="Datum8"> Samstag, 13.12.2025</label>
      </div>
    </div>

    <div class="actions">
      <button class="button" type="submit">Antwort absenden</button>
      <button class="button ghost" type="reset">Zurücksetzen</button>
    </div>
  </form>

  <footer>© Mario Haselsteiner • Frohe Weihnachten 🎄</footer>
</div>

<div id="loadingSpinner"><div class="spinner"></div></div>

<div id="thankYouPopup">
  <div class="popup-content">
    Danke für die Rückmeldung! 🎄<br>
    <button class="close-btn" onclick="closePopup()">Schließen</button>
  </div>
</div>

<script>
function closePopup(){ document.getElementById('thankYouPopup').classList.remove('show'); }

const spinner = document.getElementById('loadingSpinner');
const form = document.getElementById('surveyForm');
const scriptURL = "https://script.google.com/macros/s/AKfycbzliV-H2Jzu_hzmURtrimcey4AJmOJs8h47CzYtGC49g7H_SDqJa7h_gDKcRLMUp2dd5A/exec";

// Formular absenden mit TRUE/FALSE für jede Checkbox
form.addEventListener('submit', async (e)=>{
  e.preventDefault();
  spinner.classList.add('show');

  const fd = new FormData(form);
  const obj = { timestamp: new Date().toISOString(), name: fd.get('name') };

  const checkboxes = form.querySelectorAll('input[type="checkbox"]');
  checkboxes.forEach(cb => obj[cb.name] = cb.checked);

  try{
    const res = await fetch(scriptURL,{method:"POST",body:JSON.stringify(obj)});
    spinner.classList.remove('show');
    if(res.ok){ 
      form.reset(); 
      document.getElementById('thankYouPopup').classList.add('show'); 
    } else alert("Fehler: "+res.status);
  }catch(err){ 
    spinner.classList.remove('show');
    alert("Senden fehlgeschlagen: "+err.message); 
  }
});

// Weihnachts-Animationen
const icons=["🎅","🎄"];
function flyIcon(){
  const el=document.createElement('div');
  el.className='fly';
  el.textContent=icons[Math.floor(Math.random()*icons.length)];
  el.style.left=Math.random()*window.innerWidth+'px';
  const duration = 6 + Math.random()*6;
  const drift = (Math.random()*300 - 150);
  el.animate([{transform:`translate(${drift}px,0)`},{transform:`translate(${drift}px,-120vh)`}],{duration:duration*1000, easing:'linear'});
  el.style.bottom='0';
  const size = 15+Math.random()*20;
  el.style.fontSize=size+'px';
  document.body.appendChild(el);
  setTimeout(()=>el.remove(), duration*1000);
}
setInterval(flyIcon,400);

function createSnowflake(){
  const flake=document.createElement('div');
  flake.className='snowflake';
  flake.textContent='❄';
  flake.style.left=Math.random()*window.innerWidth+'px';
  flake.style.top='-20px';
  const size = 15+Math.random()*20;
  flake.style.fontSize=size;
  const duration = 5+Math.random()*10;
  const drift = (Math.random()*200 -100);
  flake.animate([{transform:'translateX(0) translateY(0) rotate(0deg)'},{transform:`translateX(${drift}px) translateY(${window.innerHeight+50}px) rotate(360deg)`}],{duration:duration*1000, easing:'linear'});
  document.body.appendChild(flake);
  setTimeout(()=>flake.remove(),duration*1000);
}
setInterval(createSnowflake,200);

const colors=['#0ff','#f0f','#ff0','#0f0','#f00','#00f'];
for(let i=0;i<6;i++){
  const spot=document.createElement('div');
  spot.className='spotlight';
  const color = colors[i%colors.length];
  spot.style.background=`radial-gradient(circle, ${color} 0%, transparent 70%)`;
  spot.style.left=Math.random()*window.innerWidth+'px';
  spot.style.top=Math.random()*window.innerHeight+'px';
  document.body.appendChild(spot);
}
</script>
</body>
</html>
